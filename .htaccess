# .htaccess
RewriteEngine On

# Set PHP version to 8.0
AddHandler application/x-httpd-php80 .php

# Security headers
Header always set X-Content-Type-Options nosniff
Header always set X-Frame-Options DENY
Header always set X-XSS-Protection "1; mode=block"
Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"

# Increase limits for file processing
php_value memory_limit 256M
php_value max_execution_time 300
php_value upload_max_filesize 50M
php_value post_max_size 50M

# Prevent access to sensitive files
<Files ~ "\.(env|log|sql|key)$">
    Deny from all
</Files>

<Files "config/">
    Deny from all
</Files>

<Files "includes/">
    Deny from all
</Files>

# Redirect to HTTPS if available
RewriteCond %{HTTPS} off
RewriteCond %{HTTP:X-Forwarded-Proto} !https
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Clean URLs - Remove .php extension
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ $1.php [L]

# Default page
DirectoryIndex pages/login.php